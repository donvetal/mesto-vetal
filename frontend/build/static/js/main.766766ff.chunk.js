(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{33:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),c=n(25),i=n.n(c),o=(n(33),n(27)),r=n(4),l=n.p+"static/media/header-logo.abb64ac9.svg",u=n(2),p=n(8),d=n(0);var j=function(e){var t=e.userData.email;return Object(d.jsxs)("header",{className:"header page__container",children:[Object(d.jsx)("img",{src:l,alt:"\u043b\u043e\u0433\u043e\u0442\u0438\u043f",className:"header__logo"}),Object(d.jsxs)(u.d,{children:[Object(d.jsx)(u.b,{path:"/signup",children:Object(d.jsx)(p.b,{to:"/signin",className:"header__link",children:"\u0412\u043e\u0439\u0442\u0438"})}),Object(d.jsx)(u.b,{path:"/signin",children:Object(d.jsx)(p.b,{to:"/signup",className:"header__link",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})}),Object(d.jsx)(u.b,{path:"/",children:Object(d.jsxs)("div",{className:"header__logged",children:[Object(d.jsx)("p",{className:"header__email",children:t}),Object(d.jsx)(p.b,{onClick:e.onSignOut,to:"/signin",className:"header__link",children:"\u0412\u044b\u0439\u0442\u0438"})]})})]})]})},h=n.p+"static/media/pen-only.9d2eb8c1.svg",m=s.a.createContext();var b=function(e){var t=e.onCardClick,n=e.onCardDelete,a=e.onCardLike,c=e.cardLink,i=e.cardName,o=e.cardLikes,r=e.card,l=s.a.useContext(m),u=r.owner._id===l._id,p="card__trash ".concat(u?"card__trash_visible":"card__trash_hidden"),j=r.likes.some((function(e){return e._id===l._id})),h="card__like ".concat(j?"card__like_active":"card__like_disabled");return Object(d.jsxs)("li",{className:"card",children:[Object(d.jsx)("button",{type:"button",onClick:function(){n(r)},className:p}),Object(d.jsx)("img",{onClick:function(){return t(r)},src:c,alt:i,className:"card__image"}),Object(d.jsxs)("div",{className:"card__conteiner",children:[Object(d.jsx)("h2",{className:"card__name",children:i}),Object(d.jsxs)("div",{className:"card__like-conteiner",children:[Object(d.jsx)("button",{onClick:function(){a(r)},type:"button",className:h}),Object(d.jsx)("p",{className:"card__like-number",children:o})]})]})]})};var _=function(e){var t=e.onEditAvatar,n=e.onEditProfile,a=e.onAddPlace,c=e.cards,i=e.handleCardClick,o=e.onCardLike,r=e.onCardDelete,l=s.a.useContext(m);return Object(d.jsxs)("main",{className:"content",children:[Object(d.jsxs)("section",{className:"profile page__container",children:[Object(d.jsxs)("div",{className:"profile__container",children:[Object(d.jsx)("img",{src:l.avatar,alt:"\u0430\u0432\u0430\u0442\u0430\u0440 \u043f\u0440\u043e\u0444\u0430\u0439\u043b\u0430",className:"profile__avatar"}),Object(d.jsx)("div",{className:"profile__overlay",children:Object(d.jsx)("img",{onClick:t,src:h,alt:"\u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440 \u0430\u0432\u0430\u0442\u0430\u0440\u0430",className:"profile__avatar-pen"})})]}),Object(d.jsxs)("div",{className:"profile__info",children:[Object(d.jsxs)("div",{className:"profile__title",children:[Object(d.jsx)("h1",{className:"profile__name",children:l.name}),Object(d.jsx)("button",{onClick:n,type:"button",className:"profile__button"})]}),Object(d.jsx)("p",{className:"profile__description",children:l.about})]}),Object(d.jsx)("button",{onClick:a,type:"button",className:"profile__add-button"})]}),Object(d.jsx)("section",{className:"elements page__container",children:Object(d.jsx)("ul",{className:"elements-cards",children:c.map((function(e,t){return Object(d.jsx)(b,{onCardClick:i,onCardLike:o,onCardDelete:r,cardLink:e.link,cardName:e.name,alt:e.name,cardLikes:e.likes.length,card:e},e._id)}))})})]})};var f=function(){return Object(d.jsx)("footer",{className:"footer page__container",children:Object(d.jsx)("p",{className:"footer__copyright",children:"\xa92020. Mesto Russia"})})};var O=function(e){var t=e.name,n=e.isOpen,a=e.onClose,s=e.onSubmit,c=e.title,i=e.children,o=e.buttonName;return Object(d.jsx)("div",{className:"popup popup_type_".concat(t," ").concat(n?"popup_opened":""),children:Object(d.jsxs)("div",{className:"popup__content",children:[Object(d.jsx)("button",{onClick:a,type:"button",className:"popup__close popup__close_type_".concat(t)}),Object(d.jsxs)("form",{onSubmit:s,action:"#",name:"popup-form",className:"popup__form popup__form_type_".concat(t),noValidate:!0,children:[Object(d.jsx)("h2",{className:"popup__title",children:c}),i,Object(d.jsx)("button",{type:"submit",className:"popup__btn",children:o})]})]})})};var g=function(e){var t=e.isOpen,n=e.onClose,a=e.card;return Object(d.jsx)("div",{className:"popup popup_type_image ".concat(t?"popup_opened":""),children:Object(d.jsxs)("div",{className:"popup__container",children:[Object(d.jsx)("button",{onClick:n,type:"button",className:"popup__close popup__close_type_image"}),Object(d.jsx)("img",{src:a.link,alt:a.name,className:"popup__image"}),Object(d.jsx)("p",{className:"popup__description",children:a.name})]})})},x=n(16),v=n(12),N=n(13),C=new(function(){function e(t){var n=this;Object(v.a)(this,e),this.getCardList=function(){return n._fetch("GET","/cards")},this.getUserInfo=function(){return n._fetch("GET","/users/me")},this.deleteLike=function(e){return n._fetch("DELETE","/cards/likes/"+e)},this.putLike=function(e){return n._fetch("PUT","/cards/likes/"+e)},this.changeLikeCardStatus=function(e,t){return t?n.putLike(e):n.deleteLike(e)},this.deleteCard=function(e){return n._fetch("DELETE","/cards/"+e)},this.setUserInfo=function(e,t){return n._fetch("PATCH","/users/me",{name:e,about:t})},this.setUserAvatar=function(e){return n._fetch("PATCH","/users/me/avatar",{avatar:e})},this.addNewCard=function(e){return n._fetch("POST","/cards",e)},this.url=t.url,this.headers=t.headers}return Object(N.a)(e,[{key:"_fetch",value:function(e,t,n){var a={method:e,headers:this.headers};return"PATCH"!==e&&"POST"!==e||!n||(a=Object(x.a)(Object(x.a)({},a),{},{body:JSON.stringify(n)})),fetch(this.url+"cohort-25"+t,a).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}}]),e}())({url:"https://mesto.nomoreparties.co/v1/",headers:{authorization:"6c5c2ad0-ab62-45ad-b6d9-d0d31ad5dd6b","Content-type":"application/json"}});var k=function(e){var t=e.isOpen,n=e.onUpdateUser,a=e.onClose,c=s.a.useContext(m),i=s.a.useState(""),o=Object(r.a)(i,2),l=o[0],u=o[1],p=s.a.useState(""),j=Object(r.a)(p,2),h=j[0],b=j[1];return s.a.useEffect((function(){u(c.name),b(c.about)}),[c,t]),Object(d.jsxs)(O,{name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonName:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onSubmit:function(e){e.preventDefault(),n({name:l,about:h})},onClose:a,children:[Object(d.jsx)("input",{onChange:function(e){u(e.target.value)},value:l||"",id:"popup-name",type:"text",name:"popup-name",placeholder:"\u0418\u043c\u044f",className:"popup__input popup__input_type_name",minLength:"2",maxLength:"40",required:!0}),Object(d.jsx)("span",{className:"popup__input-error",id:"popup-name-error"}),Object(d.jsx)("input",{onChange:function(e){b(e.target.value)},value:h||"",id:"popup-job",type:"text",name:"popup-job",placeholder:"\u041e \u0441\u0435\u0431\u0435",className:"popup__input popup__input_type_job",minLength:"2",maxLength:"200",required:!0}),Object(d.jsx)("span",{className:"popup__input-error",id:"popup-job-error"})]})};var y=function(e){var t=e.onUpdateAvatar,n=e.isOpen,a=e.onClose,c=s.a.createRef();return s.a.useEffect((function(){c.current.value=""}),[c,n]),Object(d.jsxs)(O,{name:"update-avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonName:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onSubmit:function(e){e.preventDefault(),t(c.current.value)},isOpen:n,onClose:a,children:[Object(d.jsx)("input",{ref:c,id:"avatar-link",type:"url",name:"avatar-link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",className:"popup__input popup__input_type_avatar-link",required:!0}),Object(d.jsx)("span",{className:"popup__input-error",id:"avatar-link-error"})]})};var S=function(e){var t=e.onAddPlaceSubmit,n=e.isOpen,a=e.onClose,c=s.a.createRef(),i=s.a.createRef();return s.a.useEffect((function(){c.current.value="",i.current.value=""}),[c,i,n]),Object(d.jsxs)(O,{name:"mesto",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",onSubmit:function(e){e.preventDefault(),t(e,{link:c.current.value,name:i.current.value})},isOpen:n,onClose:a,buttonName:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",children:[Object(d.jsx)("input",{ref:i,id:"mesto-name",type:"text",name:"mesto-name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"popup__input popup__input_type_mesto-name",minLength:"2",maxLength:"30",required:!0}),Object(d.jsx)("span",{className:"popup__input-error",id:"mesto-name-error"}),Object(d.jsx)("input",{ref:c,id:"mesto-image-link",type:"url",name:"mesto-image-link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__input popup__input_type_mesto-image-link",required:!0}),Object(d.jsx)("span",{className:"popup__input-error",id:"mesto-image-link-error"})]})},L=n(11),w=n(9),E=n(19),P=n(18),T=function(e){Object(E.a)(n,e);var t=Object(P.a)(n);function n(e){var a;return Object(v.a)(this,n),(a=t.call(this,e)).state={email:"",password:""},a.handleChange=a.handleChange.bind(Object(w.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(w.a)(a)),a}return Object(N.a)(n,[{key:"handleChange",value:function(e){var t=e.target,n=t.name,a=t.value;this.setState(Object(L.a)({},n,a))}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.state.password&&this.state.email&&this.props.handleLogin(this.state.password,this.state.email)}},{key:"render",value:function(){return Object(d.jsxs)("div",{className:"login",children:[Object(d.jsx)("p",{className:"login__title",children:"\u0412\u0445\u043e\u0434"}),Object(d.jsxs)("form",{onSubmit:this.handleSubmit,className:"login__form",children:[Object(d.jsx)("input",{onChange:this.handleChange,value:this.state.email,id:"email",type:"email",name:"email",placeholder:"Email",className:"login__input login__input_type_email",minLength:"5",maxLength:"40",required:!0}),Object(d.jsx)("input",{onChange:this.handleChange,value:this.state.password,id:"password",type:"password",name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",className:"login__input login__input_password",minLength:"8",maxLength:"200",required:!0}),Object(d.jsx)("button",{type:"submit",className:"login__btn",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})}}]),n}(s.a.Component),A=Object(u.g)(T),D=function(e){Object(E.a)(n,e);var t=Object(P.a)(n);function n(e){var a;return Object(v.a)(this,n),(a=t.call(this,e)).handleChange=function(e){var t=e.target,n=t.name,s=t.value;a.setState(Object(L.a)({},n,s))},a.handleSubmit=function(e){e.preventDefault(),a.props.onRegister(a.state.password,a.state.email)},a.state={email:"",password:""},a.handleChange=a.handleChange.bind(Object(w.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(w.a)(a)),a}return Object(N.a)(n,[{key:"render",value:function(){return Object(d.jsxs)("div",{className:"register",children:[Object(d.jsx)("p",{className:"register__title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(d.jsxs)("form",{onSubmit:this.handleSubmit,className:"register__form",children:[Object(d.jsx)("input",{onChange:this.handleChange,value:this.state.email,id:"email",type:"email",name:"email",placeholder:"Email",className:"register__input register__input_type_email",minLength:"5",maxLength:"40",required:!0}),Object(d.jsx)("input",{onChange:this.handleChange,value:this.state.password,id:"password",type:"password",name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",className:"register__input register__input_password",minLength:"8",maxLength:"200",required:!0}),Object(d.jsx)("button",{type:"submit",className:"register__btn",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"}),Object(d.jsxs)("p",{className:"register__signin",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?",Object(d.jsx)(p.b,{to:"/signin",className:"register__signin-link",children:" \u0412\u043e\u0439\u0442\u0438"})]})]})]})}}]),n}(s.a.Component),U=Object(u.g)(D);var I=function(e){var t=e.isOpen,n=e.onClose,a=e.title,s=e.image;return Object(d.jsx)("div",{className:"popup popup_type_info-tooltip ".concat(t?"popup_opened":""),children:Object(d.jsxs)("div",{className:"popup__content",children:[Object(d.jsx)("button",{onClick:n,type:"button",className:"popup__close popup__close_type_info-tooltip"}),Object(d.jsx)("img",{src:s,alt:"\u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",className:"popup__info-tooltip-image"}),Object(d.jsx)("p",{className:"popup__info-tooltip-title",children:a})]})})},q=n(28),R=["component"],J=function(e){var t=e.component,n=Object(q.a)(e,R);return Object(d.jsx)(u.b,{children:function(){return n.loggedIn?Object(d.jsx)(t,Object(x.a)({},n)):Object(d.jsx)(u.a,{to:"./signin"})}})},F=n.p+"static/media/info-tooltip-fail.df8eddf6.svg",B=n.p+"static/media/info-tooltip-success.1b6082f8.svg",G="https://auth.nomoreparties.co";var H=Object(u.g)((function(e){var t=s.a.useState(!1),n=Object(r.a)(t,2),c=n[0],i=n[1],l=s.a.useState(!1),p=Object(r.a)(l,2),h=p[0],b=p[1],x=s.a.useState(!1),v=Object(r.a)(x,2),N=v[0],L=v[1],w=s.a.useState(!1),E=Object(r.a)(w,2),P=E[0],T=E[1],D=s.a.useState(!1),q=Object(r.a)(D,2),R=q[0],H=q[1],z=s.a.useState(!1),M=Object(r.a)(z,2),V=M[0],K=M[1],Q=s.a.useState({}),W=Object(r.a)(Q,2),X=W[0],Y=W[1];Object(a.useEffect)((function(){if(localStorage.getItem("token")){var t=localStorage.getItem("token");(n=t,fetch("".concat(G,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}}).then((function(e){return e.json()})).then((function(e){return e}))).then((function(e){e&&(Y({email:e.data.email}),i(!0))})).then((function(){e.history.push("/")})).catch((function(e){console.log(e)}))}var n}),[e.history]);var Z=function(){K(!1),L(!1),T(!1),H(!1),ue(!1)},$=s.a.useState([]),ee=Object(r.a)($,2),te=ee[0],ne=ee[1],ae=s.a.useState({}),se=Object(r.a)(ae,2),ce=se[0],ie=se[1],oe=s.a.useState(!1),re=Object(r.a)(oe,2),le=re[0],ue=re[1];Object(a.useEffect)((function(){C.getCardList().then((function(e){ne(e)})).catch((function(e){console.log(e)}))}),[]);var pe=s.a.useState({}),de=Object(r.a)(pe,2),je=de[0],he=de[1];return Object(a.useEffect)((function(){C.getUserInfo().then((function(e){he(e)})).catch((function(e){console.log(e)}))}),[]),Object(d.jsx)("div",{className:"App",children:Object(d.jsx)(m.Provider,{value:je,children:Object(d.jsxs)("div",{className:"page",children:[Object(d.jsx)(j,{onSignOut:function(){localStorage.removeItem("token"),b(!1)},userData:X}),Object(d.jsxs)(u.d,{children:[Object(d.jsxs)(u.b,{path:"/signin",children:[Object(d.jsx)(I,{isOpen:V,onClose:Z,image:F,title:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."}),Object(d.jsx)(A,{handleLogin:function(t,n){(function(e,t){return fetch("".concat(G,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then((function(e){return e.json()})).then((function(e){if(e.token)return e}))})(t,n).then((function(t){t&&t.hasOwnProperty("token")?(localStorage.setItem("token",t.token),Y({email:n}),i(!0),e.history.push("/")):K(!0)})).catch((function(e){K(!0),console.log(e)}))}})]}),Object(d.jsxs)(u.b,{path:"/signup",children:[Object(d.jsx)(I,{isOpen:V,onClose:function(){Z(),h&&setTimeout((function(){return e.history.push("/signin")}),1e3)},image:h?B:F,title:h?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."}),Object(d.jsx)(U,{onRegister:function(e,t){(function(e,t){return fetch("".concat(G,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then((function(e){return e.json()})).then((function(e){return e}))})(e,t).then((function(e){e.hasOwnProperty("error")?b(!1):b(!0),K(!0)})).catch((function(e){return console.log(e)}))}})]}),Object(d.jsxs)(u.b,{children:[Object(d.jsx)(J,{exact:!0,path:"/",loggedIn:c,component:_,onEditProfile:function(){L(!0)},onAddPlace:function(){T(!0)},onEditAvatar:function(){H(!0)},cards:te,handleCardClick:function(e){ie(e),ue(!0)},setCards:ne,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===je._id}));C.changeLikeCardStatus(e._id,!t).then((function(t){ne((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){console.log(e)}))},onCardDelete:function(e){C.deleteCard(e._id).then((function(t){ne((function(t){return t.filter((function(t){return t._id!==e._id}))}))})).catch((function(e){console.log(e)}))}}),c?Object(d.jsx)(u.a,{to:"/"}):Object(d.jsx)(u.a,{to:"/signin"})]})]}),Object(d.jsx)(f,{}),Object(d.jsx)(k,{isOpen:N,onUpdateUser:function(e){C.setUserInfo(e.name,e.about).then((function(e){he(e),Z()})).catch((function(e){console.log(e)}))},onClose:Z}),Object(d.jsx)(S,{isOpen:P,onAddPlaceSubmit:function(e,t){C.addNewCard(t).then((function(e){ne([e].concat(Object(o.a)(te))),Z()})).catch((function(e){console.log(e)}))},onClose:Z}),Object(d.jsx)(y,{isOpen:R,onUpdateAvatar:function(e){C.setUserAvatar(e).then((function(e){he(e),Z()})).catch((function(e){console.log(e)}))},onClose:Z}),Object(d.jsx)(O,{name:"delete-image",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonName:"\u0414\u0430"}),Object(d.jsx)(g,{card:ce,onClose:Z,isOpen:le})]})})})})),z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,41)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),s(e),c(e),i(e)}))};i.a.render(Object(d.jsx)(s.a.StrictMode,{children:Object(d.jsx)(p.a,{children:Object(d.jsx)(H,{})})}),document.getElementById("root")),z()}},[[40,1,2]]]);
//# sourceMappingURL=main.766766ff.chunk.js.map